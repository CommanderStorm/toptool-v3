{% extends "base.html" %}
{% load i18n %}
{% load bootstrap3 %}

{% block title %}{{ meetingtype }} - {% trans "Sitzungsarchiv" %}{% endblock %}

{% block content %}
    <h1>{{ meetingtype.name }}: {% trans "Sitzungen im Jahr" %} {{ year }}</h1>

    <div class="table-responsive">
    <table class="table table-striped table-hover">
    <thead>
    <tr>
        <th>{% trans "Sitzung" %}</th>
        <th>{% trans "Datum" %}</th>
        <th>{% trans "Zeit" %}</th>
        <th>{% trans "Raum" %}</th>
        {% if meetingtype.protokoll %}<th>{% trans "Protokoll" %}</th>{% endif %}
        <th>{% trans "Bearbeiten" %}</th>
    </tr>
    </thead>
    <tbody>
    {% for meeting in meetings %}
        <tr>
            <td><a href="{% url "viewmeeting" meetingtype.id meeting.id %}">
                    {{ meeting.get_title }}{% if user == meeting.sitzungsleitung %} {% bootstrap_icon "user" %}{% endif %}{% if meetingtype.protokoll and user == meeting.protokollant %} {% bootstrap_icon "pencil" %}{% endif %}</a></td>
            <td>{{ meeting.time | date:"D" }} {{ meeting.time | date:"SHORT_DATE_FORMAT" }}</td>
            <td>{{ meeting.time | date:"TIME_FORMAT" }}</td>
            <td>{{ meeting.room | urlize }}</td>
            {% if meetingtype.protokoll %}
                <td>
                    {% if meeting.protokoll and meeting.protokoll.published %}
                        {% if meetingtype.permission in perms or meeting.protokoll.approved %}
                            <a href="{% url "protokoll" meetingtype.id meeting.id "html" %}" class="asbtn-left">{% if meeting.protokoll.approved %}{% bootstrap_icon "floppy-saved" %}{% else %}{% bootstrap_icon "floppy-disk" %}{% endif %} HTML</a>
                            <a href="{% url "protokoll" meetingtype.id meeting.id "pdf" %}" class="asbtn">{% if meeting.protokoll.approved %}{% bootstrap_icon "floppy-saved" %}{% else %}{% bootstrap_icon "floppy-disk" %}{% endif %} PDF</a>
                            <a href="{% url "protokoll" meetingtype.id meeting.id "txt" %}" class="asbtn-right">{% if meeting.protokoll.approved %}{% bootstrap_icon "floppy-saved" %}{% else %}{% bootstrap_icon "floppy-disk" %}{% endif %} TXT</a>
                        {% endif %}
                    {% endif %}
                </td>
            {% endif %}
            <td>
                {% if meetingtype.admin_permission in perms or user == meeting.sitzungsleitung %}
                    <a href="{% url "editmeeting" meetingtype.id meeting.id %}" class="asbtn">{% bootstrap_icon "edit" %} {% trans "bearbeiten" %}</a>
                {% endif %}
                {% if meetingtype.admin_permission in perms %}
                    <a href="{% url "delmeeting" meetingtype.id meeting.id %}" class="asbtn">{% bootstrap_icon "trash" %} {% trans "l√∂schen" %}</a>
                {% endif %}
            </td>
        </tr>
    {% endfor %}
    </tbody>
    </table>
    </div>

    <h2>{% trans "Archiv" %}</h2>
    <nav aria-label="Archive">
        <ul class="pagination">
            {% if prev %}
                <li>
                    <a href="{% url "viewarchive" meetingtype.id prev %}" aria-label="Previous">
                        <noscript><span aria-hidden="true">&laquo;</span></noscript>
                        {% bootstrap_icon "chevron-left" %}
                    </a>
                </li>
            {% else %}
                <li class="disabled">
                    <span aria-label="Previous">
                        <noscript><span aria-hidden="true">&laquo;</span></noscript>
                        {% bootstrap_icon "chevron-left" %}
                    </span>
                </li>
            {% endif %}
            {% for y in years %}
                {% if y == year %}
                    <li class="active"><span>{{ y }}</span></li>
                {% else %}
                    <li><a href="{% url "viewarchive" meetingtype.id y %}">{{ y }}</a></li>
                {% endif %}
            {% endfor %}
            {% if next %}
                <li>
                    <a href="{% url "viewarchive" meetingtype.id next %}" aria-label="Next">
                        <noscript><span aria-hidden="true">&raquo;</span></noscript>
                        {% bootstrap_icon "chevron-right" %}
                    </a>
                </li>
            {% else %}
                <li class="disabled">
                    <span aria-label="Next">
                        <noscript><span aria-hidden="true">&raquo;</span></noscript>
                        {% bootstrap_icon "chevron-right" %}
                    </span>
                </li>
            {% endif %}
        </ul>
    </nav>
{% endblock %}
