{% extends "base.html" %}
{% load i18n %}

{% block title %}{{ meetingtype }} - {% trans "Sitzungsarchiv" %}{% endblock %}

{% block content %}
    <h1>{{ meetingtype.name }}: {% trans "Sitzungen im Jahr" %} {{ year }}</h1>

    <table class="table">
    <tr>
        <th>{% trans "Sitzung" %}</th>
        <th>{% trans "Datum" %}</th>
        <th>{% trans "Zeit" %}</th>
        <th>{% trans "Raum" %}</th>
        <th>{% trans "Protokoll" %}</th>
        <th>{% trans "Bearbeiten" %}</th>
    </tr>
    {% for meeting in meetings %}
        <tr>
            <td><a href="{% url "viewmeeting" meetingtype.id meeting.id %}">{{ meeting.get_title }}</a></td>
            <td>{{ meeting.time | date:"D" }} {{ meeting.time | date:"SHORT_DATE_FORMAT" }}</td>
            <td>{{ meeting.time | date:"TIME_FORMAT" }}</td>
            <td>{{ meeting.room }}</td>
            <td>
                {% if meeting.protokoll %}
                    {% if meetingtype.permission in perms or meeting.protokoll.approved %}
                        {% if user == meeting.protokollant %}
                            <a href="{% url "protokoll" meetingtype.id meeting.id "html" %}" class="btn btn-default btn-sm btn-primary">HTML</a>
                            <a href="{% url "protokoll" meetingtype.id meeting.id "pdf" %}" class="btn btn-default btn-sm btn-primary">PDF</a>
                            <a href="{% url "protokoll" meetingtype.id meeting.id "txt" %}" class="btn btn-default btn-sm btn-primary">TXT</a>
                        {% else %}
                            <a href="{% url "protokoll" meetingtype.id meeting.id "html" %}" class="btn btn-default btn-sm">HTML</a>
                            <a href="{% url "protokoll" meetingtype.id meeting.id "pdf" %}" class="btn btn-default btn-sm">PDF</a>
                            <a href="{% url "protokoll" meetingtype.id meeting.id "txt" %}" class="btn btn-default btn-sm">TXT</a>
                        {% endif %}
                    {% endif %}
                {% elif not meeting.imported %}
                    {% if not meeting.protokollant and meetingtype.permission in perms %}
                        <a href="{% url "editprotokoll" meetingtype.id meeting.id %}" class="btn btn-default btn-sm">{% trans "hinzufügen" %}</a>
                    {% elif meetingtype.admin_permission in perms or user == meeting.sitzungsleitung or user == meeting.protokollant %}
                        {% if user == meeting.protokollant %}
                            <a href="{% url "editprotokoll" meetingtype.id meeting.id %}" class="btn btn-default btn-sm btn-primary">{% trans "hinzufügen" %}</a>
                        {% else %}
                            <a href="{% url "editprotokoll" meetingtype.id meeting.id %}" class="btn btn-default btn-sm">{% trans "hinzufügen" %}</a>
                        {% endif %}
                    {% endif %}
                {% endif %}
            </td>
            <td>
                {% if meetingtype.admin_permission in perms or user == meeting.sitzungsleitung %}
                    <a href="{% url "editmeeting" meetingtype.id meeting.id %}" class="btn btn-default btn-sm">
                        {% trans "bearbeiten" %}</a>
                {% endif %}
                {% if meetingtype.admin_permission in perms %}
                    <a href="{% url "delmeeting" meetingtype.id meeting.id %}" class="btn btn-default btn-sm">
                        {% trans "löschen" %}</a>
                {% endif %}
            </td>
        </tr>
    {% endfor %}
    </table>

    <h2>{% trans "Archiv" %}</h2>
    <table class="table">
        <tr>
            {% for y in years %}
                {% if y == year %}
                    <td><a href="{% url "viewarchive" meetingtype.id y %}" class="btn btn-default btn-primary">{{ y }}</a></td>
                {% else %}
                    <td><a href="{% url "viewarchive" meetingtype.id y %}" class="btn btn-default">{{ y }}</a></td>
                {% endif %}
                {% if not forloop.last and forloop.counter|divisibleby:8 %}
                    </tr><tr>
                {% endif %}
            {% endfor %}
        </tr>
    </table>

    <p><a href="{% url "viewmt" meetingtype.id %}" class="btn btn-default">{% trans "Zurück zur Sitzungsübersicht" %}</a></p>
{% endblock %}
